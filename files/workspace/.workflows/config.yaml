actions:
  allunite.ddd:
    type: cmd
    path: run/last.sh
    args: "--var ${inputs.varname}"

    input:
      varname:
        type: "string"
        default: ""
        required: true
        order: 0

      varname2:
        type: "int"
        default: 0

    output:
      properties:
        id:
          type: int
        valid:
          type: boolean

  allunite.action1:
    type: cmd
    cmd: "echo \"A1 Input: {{ input.vvv }}\" && echo 'OUTPUT:{\"result\": \"action1 output\"}'"

    input:
      vvv:
        type: string

    output:
      properties:
        result:
          type: string

  allunite.action2:
    type: cmd
    cmd: "echo \"A2 Input: {{ input.vvv }}\" && echo 'OUTPUT:{\"result\": \"action2 output\"}'"

    input:
      vvv:
        type: string

    output:
      properties:
        result:
          type: string

  core.mail:
    type: cmd
    content: |
      #!/bin/sh
      
      echo 'OUTPUT: {"test": "ggg"}'

    input:
      vvv:
        type: string

    output:
      properties:
        test:
          type: string


tasks:
  task1:
    input:
      field1:
        type: string
        default: 111

    flow:
      step1:
        action: allunite.action1
        input:
          vvv: "test - {{ input.field1 }}"
        on_success: step2

      step2:
        action: allunite.action2
        input:
          vvv: "{{ step1.output.result }}"


triggers:
  trigger01:
    enabled: false
    type: "cron"
    cron: "*/5 * * * * *"
    task: task1
    input:
      vvv: "123"

globals:
  error_handler:
    path: global/error_handler.sh
    # input: path, job_id, error

